{% extends "base.html" %}

{% block title %}EhkoForge â€” Forge{% endblock %}

{% block area_styles %}
<link rel="stylesheet" href="/css/forge.css">
{% endblock %}

{% block content %}
<aside class="sidebar forge-sidebar">
    <!-- Ingot Queue Header -->
    <div class="sidebar-section-header">
        <span>Surfaced Ingots</span>
        <button class="refresh-btn" id="refresh-ingots" title="Refresh">â†»</button>
    </div>
    
    <!-- Ingot Filters -->
    <div class="ingot-filters">
        <select id="ingot-filter-tier">
            <option value="">All Tiers</option>
            <option value="mythic">ğŸ’ Mythic</option>
            <option value="gold">ğŸ¥‡ Gold</option>
            <option value="silver">ğŸ¥ˆ Silver</option>
            <option value="iron">âš™ï¸ Iron</option>
            <option value="copper">ğŸ”¶ Copper</option>
        </select>
    </div>
    
    <!-- Ingot List -->
    <div class="ingot-list" id="ingot-list">
        <!-- Populated by JS -->
    </div>
    
    <!-- Smelt Status -->
    <div class="smelt-status" id="smelt-status">
        <div class="smelt-header">
            <span>Smelt Queue</span>
        </div>
        <div class="smelt-info">
            <span id="smelt-pending">0 pending</span>
        </div>
        <div class="smelt-actions">
            <button class="smelt-btn queue-btn" id="queue-all" title="Queue all forged sessions">ğŸ“¥ Queue All</button>
            <button class="smelt-btn run-btn" id="run-smelt" title="Run Smelt">âš’ï¸ Smelt</button>
        </div>
    </div>
    
    <!-- Sidebar Footer -->
    <div class="sidebar-footer">
        <div class="ehko-state-sidebar" id="ehko-state-sidebar">
            <span class="state-icon">â—‡</span>
            <span class="state-text">Nascent</span>
        </div>
    </div>
</aside>

<main class="main-panel forge-main">
    <!-- Ehko Avatar Zone -->
    <div class="avatar-zone" id="avatar-zone">
        <div class="avatar" id="avatar">
            <div class="avatar-core"></div>
            <div class="avatar-ring avatar-ring-1"></div>
            <div class="avatar-ring avatar-ring-2"></div>
        </div>
        <div class="avatar-status" id="avatar-status">Ready</div>
        <!-- Compact Stats Bar -->
        <div class="stats-bar-compact" id="stats-bar">
            <span class="stat-item" data-stat="identity_depth" title="Identity Depth">â—‡</span>
            <span class="stat-item" data-stat="clarity" title="Clarity">âœ¦</span>
            <span class="stat-item" data-stat="resonance" title="Resonance">â—</span>
            <span class="stat-item" data-stat="anchors" title="Anchors">âš“</span>
        </div>
    </div>
    
    <!-- Ingot Detail Area -->
    <div class="ingot-area" id="ingot-area">
        <div class="ingot-detail" id="ingot-detail">
            <div class="ingot-empty">
                <p>Select an ingot from the queue to review.</p>
                <p class="subtle">Accept valuable insights to forge them into your Ehko.</p>
            </div>
        </div>
    </div>
</main>

<!-- Ingot Detail Modal (for mobile/alternative view) -->
<div class="ingot-overlay" id="ingot-overlay">
    <div class="ingot-modal">
        <div class="ingot-modal-header">
            <h2>Ingot Details</h2>
            <button class="close-ingot-modal" id="close-ingot-modal">Ã—</button>
        </div>
        <div class="ingot-modal-content" id="ingot-modal-content">
            <!-- Populated by JS -->
        </div>
        <div class="ingot-modal-actions">
            <button class="ingot-reject" id="ingot-reject">
                <span>âœ—</span> Reject
            </button>
            <button class="ingot-defer" id="ingot-defer">
                <span>â¸</span> Defer
            </button>
            <button class="ingot-accept" id="ingot-accept">
                <span>â—ˆ</span> Forge into Ehko
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block area_scripts %}
<script src="/js/forge.js"></script>
{% endblock %}
